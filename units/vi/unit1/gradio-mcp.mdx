# TÃ­ch há»£p Gradio vá»›i MCP

Giá» chÃºng ta Ä‘Ã£ tÃ¬m hiá»ƒu cÃ¡c khÃ¡i niá»‡m cá»‘t lÃµi cá»§a Giao Thá»©c Ngá»¯ Cáº£nh MÃ´ HÃ¬nh (MCP) vÃ  cÃ¡ch triá»ƒn khai MCP Servers vÃ  Clients. Trong pháº§n nÃ y, chÃºng ta sáº½ lÃ m má»i thá»© dá»… dÃ ng hÆ¡n báº±ng cÃ¡ch sá»­ dá»¥ng Gradio Ä‘á»ƒ táº¡o má»™t MCP Server!

<Tip>

Gradio lÃ  thÆ° viá»‡n Python ná»•i tiáº¿ng giÃºp táº¡o giao diá»‡n web tÃ¹y chá»‰nh nhanh chÃ³ng cho cÃ¡c mÃ´ hÃ¬nh há»c mÃ¡y.

</Tip>

## Giá»›i thiá»‡u vá» Gradio

Gradio cho phÃ©p cÃ¡c nhÃ  phÃ¡t triá»ƒn táº¡o giao diá»‡n ngÆ°á»i dÃ¹ng (UI) cho mÃ´ hÃ¬nh cá»§a há» chá»‰ vá»›i vÃ i dÃ²ng mÃ£ Python. ThÆ° viá»‡n nÃ y Ä‘áº·c biá»‡t há»¯u Ã­ch cho:

- Táº¡o demo vÃ  nguyÃªn máº«u
- Chia sáº» mÃ´ hÃ¬nh vá»›i ngÆ°á»i dÃ¹ng khÃ´ng chuyÃªn vá» ká»¹ thuáº­t
- Kiá»ƒm tra vÃ  gá»¡ lá»—i hÃ nh vi cá»§a mÃ´ hÃ¬nh

Vá»›i viá»‡c há»— trá»£ thÃªm MCP, Gradio giá» Ä‘Ã¢y cung cáº¥p cÃ¡ch Ä‘Æ¡n giáº£n Ä‘á»ƒ hiá»ƒn thá»‹ cÃ¡c kháº£ nÄƒng cá»§a mÃ´ hÃ¬nh AI thÃ´ng qua giao thá»©c MCP chuáº©n hÃ³a.

Káº¿t há»£p Gradio vá»›i MCP cho phÃ©p báº¡n táº¡o cáº£ giao diá»‡n thÃ¢n thiá»‡n vá»›i con ngÆ°á»i vÃ  cÃ´ng cá»¥ truy cáº­p Ä‘Æ°á»£c báº±ng AI vá»›i mÃ£ tá»‘i thiá»ƒu. Äiá»u tuyá»‡t nháº¥t lÃ  Gradio Ä‘Ã£ Ä‘Æ°á»£c cá»™ng Ä‘á»“ng AI sá»­ dá»¥ng rá»™ng rÃ£i, vÃ¬ váº­y báº¡n cÃ³ thá»ƒ dÃ¹ng nÃ³ Ä‘á»ƒ chia sáº» MCP Servers cá»§a mÃ¬nh vá»›i ngÆ°á»i khÃ¡c.

## Äiá»u kiá»‡n tiÃªn quyáº¿t

Äá»ƒ sá»­ dá»¥ng Gradio vá»›i há»— trá»£ MCP, báº¡n cáº§n cÃ i Ä‘áº·t Gradio vá»›i pháº§n má»Ÿ rá»™ng MCP:

```bash
pip install "gradio[mcp]"
```

Báº¡n cÅ©ng cáº§n má»™t á»©ng dá»¥ng LLM há»— trá»£ gá»i cÃ´ng cá»¥ sá»­ dá»¥ng giao thá»©c MCP, nhÆ° Cursor (Ä‘Æ°á»£c gá»i lÃ  "MCP Hosts").

## Táº¡o MCP Server vá»›i Gradio

HÃ£y cÃ¹ng xem qua vÃ­ dá»¥ cÆ¡ báº£n vá» cÃ¡ch táº¡o MCP Server báº±ng Gradio:

<details>
<summary>Báº¥m Ä‘á»ƒ xem báº£n dá»‹ch tiáº¿ng Viá»‡t</summary>
```python
import gradio as gr

def letter_counter(word: str, letter: str) -> int:
    """
    Äáº¿m sá»‘ láº§n xuáº¥t hiá»‡n cá»§a má»™t kÃ½ tá»± trong tá»« hoáº·c vÄƒn báº£n.

    Args:
        word (str): VÄƒn báº£n Ä‘áº§u vÃ o Ä‘á»ƒ tÃ¬m kiáº¿m
        letter (str): KÃ½ tá»± cáº§n tÃ¬m

    Returns:
        int: Sá»‘ láº§n kÃ½ tá»± xuáº¥t hiá»‡n trong vÄƒn báº£n
    """
    word = word.lower()
    letter = letter.lower()
    count = word.count(letter)
    return count

# Táº¡o giao diá»‡n Gradio tiÃªu chuáº©n
demo = gr.Interface(
    fn=letter_counter,
    inputs=["textbox", "textbox"],
    outputs="number",
    title="Bá»™ Ä‘áº¿m kÃ½ tá»±",
    description="Nháº­p vÄƒn báº£n vÃ  má»™t kÃ½ tá»± Ä‘á»ƒ Ä‘áº¿m sá»‘ láº§n kÃ½ tá»± Ä‘Ã³ xuáº¥t hiá»‡n trong vÄƒn báº£n."
)

# Khá»Ÿi cháº¡y cáº£ giao diá»‡n web Gradio vÃ  MCP Server
if __name__ == "__main__":
    demo.launch(mcp_server=True)
```
</details>

```python
import gradio as gr

def letter_counter(word: str, letter: str) -> int:
    """
    Count the number of occurrences of a letter in a word or text.

    Args:
        word (str): The input text to search through
        letter (str): The letter to search for

    Returns:
        int: The number of times the letter appears in the text
    """
    word = word.lower()
    letter = letter.lower()
    count = word.count(letter)
    return count

# Create a standard Gradio interface
demo = gr.Interface(
    fn=letter_counter,
    inputs=["textbox", "textbox"],
    outputs="number",
    title="Letter Counter",
    description="Enter text and a letter to count how many times the letter appears in the text."
)

# Launch both the Gradio web interface and the MCP server
if __name__ == "__main__":
    demo.launch(mcp_server=True)
```

Vá»›i thiáº¿t láº­p nÃ y, hÃ m Ä‘áº¿m kÃ½ tá»± cá»§a báº¡n giá» cÃ³ thá»ƒ truy cáº­p qua:

1. Giao diá»‡n web Gradio truyá»n thá»‘ng cho tÆ°Æ¡ng tÃ¡c trá»±c tiáº¿p cá»§a con ngÆ°á»i
2. MCP Server cÃ³ thá»ƒ káº¿t ná»‘i vá»›i cÃ¡c clients tÆ°Æ¡ng thÃ­ch

MCP server sáº½ truy cáº­p Ä‘Æ°á»£c táº¡i:
```
http://your-server:port/gradio_api/mcp/sse
```

á»¨ng dá»¥ng trÃ´ng nhÆ° tháº¿ nÃ y:

![Gradio MCP Server](https://huggingface.co/datasets/mcp-course/images/resolve/main/unit1/7.png)

## CÃ¡ch thá»©c hoáº¡t Ä‘á»™ng Ä‘áº±ng sau háº­u trÆ°á»ng

Khi báº¡n thiáº¿t láº­p `mcp_server=True` trong `launch()`, nhá»¯ng Ä‘iá»u sau sáº½ xáº£y ra:

1. CÃ¡c hÃ m Gradio Ä‘Æ°á»£c tá»± Ä‘á»™ng chuyá»ƒn Ä‘á»•i thÃ nh MCP Tools
2. CÃ¡c thÃ nh pháº§n Ä‘áº§u vÃ o Ã¡nh xáº¡ thÃ nh lÆ°á»£c Ä‘á»“ tham sá»‘ cÃ´ng cá»¥
3. CÃ¡c thÃ nh pháº§n Ä‘áº§u xÃ¡c Ä‘á»‹nh Ä‘á»‹nh dáº¡ng pháº£n há»“i
4. Server Gradio giá» cÅ©ng láº¯ng nghe cÃ¡c tin nháº¯n theo giao thá»©c MCP
5. JSON-RPC qua HTTP+SSE Ä‘Æ°á»£c thiáº¿t láº­p cho giao tiáº¿p client-server

## TÃ­nh nÄƒng chÃ­nh cá»§a tÃ­ch há»£p Gradio <> MCP

1. **Chuyá»ƒn Ä‘á»•i cÃ´ng cá»¥**: Má»—i API endpoint trong á»©ng dá»¥ng Gradio cá»§a báº¡n sáº½ tá»± Ä‘á»™ng chuyá»ƒn thÃ nh MCP tool vá»›i tÃªn, mÃ´ táº£ vÃ  lÆ°á»£c Ä‘á»“ Ä‘áº§u vÃ o tÆ°Æ¡ng á»©ng. Äá»ƒ xem cÃ¡c cÃ´ng cá»¥ vÃ  lÆ°á»£c Ä‘á»“, truy cáº­p `http://your-server:port/gradio_api/mcp/schema` hoáº·c vÃ o link "View API" á»Ÿ footer á»©ng dá»¥ng Gradio, sau Ä‘Ã³ click vÃ o "MCP".

2. **Há»— trá»£ biáº¿n mÃ´i trÆ°á»ng**: CÃ³ hai cÃ¡ch Ä‘á»ƒ kÃ­ch hoáº¡t chá»©c nÄƒng MCP server:
- DÃ¹ng tham sá»‘ `mcp_server` trong `launch()`:
  ```python
  demo.launch(mcp_server=True)
  ```
- DÃ¹ng biáº¿n mÃ´i trÆ°á»ng:
  ```bash
  export GRADIO_MCP_SERVER=True
  ```

3. **Xá»­ lÃ½ file**: Server tá»± Ä‘á»™ng xá»­ lÃ½ chuyá»ƒn Ä‘á»•i dá»¯ liá»‡u file bao gá»“m:
   - Chuyá»ƒn Ä‘á»•i chuá»—i mÃ£ hÃ³a base64 thÃ nh dá»¯ liá»‡u file
   - Xá»­ lÃ½ file áº£nh vÃ  tráº£ vá» Ä‘Ãºng Ä‘á»‹nh dáº¡ng
   - Quáº£n lÃ½ bá»™ nhá»› file táº¡m

   ChÃºng ta **nÃªn** truyá»n áº£nh/file Ä‘áº§u vÃ o dÆ°á»›i dáº¡ng URL Ä‘áº§y Ä‘á»§ ("http://..." hoáº·c "https://...") vÃ¬ MCP Client khÃ´ng pháº£i lÃºc nÃ o cÅ©ng xá»­ lÃ½ Ä‘Ãºng file local.

4. **Server MCP Ä‘Æ°á»£c host trÃªn ğŸ¤— Spaces**: Báº¡n cÃ³ thá»ƒ publish á»©ng dá»¥ng Gradio miá»…n phÃ­ trÃªn Hugging Face Spaces Ä‘á»ƒ cÃ³ MCP server Ä‘Æ°á»£c host miá»…n phÃ­. ÄÃ¢y lÃ  vÃ­ dá»¥ má»™t Space nhÆ° váº­y: https://huggingface.co/spaces/abidlabs/mcp-tools

## Máº¹o xá»­ lÃ½ sá»± cá»‘

1. **Gá»£i Ã½ kiá»ƒu vÃ  chuá»—i tÃ i liá»‡u**: Äáº£m báº£o báº¡n cung cáº¥p gá»£i Ã½ kiá»ƒu vÃ  chuá»—i tÃ i liá»‡u há»£p lá»‡ cho hÃ m. Chuá»—i tÃ i liá»‡u cáº§n cÃ³ khá»‘i "Args:" vá»›i cÃ¡c tham sá»‘ Ä‘Æ°á»£c thá»¥t lá».

2. **Äáº§u vÃ o dáº¡ng chuá»—i**: Khi khÃ´ng cháº¯c cháº¯n, hÃ£y cháº¥p nháº­n Ä‘á»‘i sá»‘ Ä‘áº§u vÃ o dáº¡ng `str` vÃ  chuyá»ƒn Ä‘á»•i sang kiá»ƒu mong muá»‘n bÃªn trong hÃ m.

3. **Há»— trá»£ SSE**: Má»™t sá»‘ MCP Host khÃ´ng há»— trá»£ MCP Server dÃ¹ng SSE. Trong trÆ°á»ng há»£p Ä‘Ã³, báº¡n cÃ³ thá»ƒ dÃ¹ng `mcp-remote`:
   ```json
   {
     "mcpServers": {
       "gradio": {
         "command": "npx",
         "args": [
           "mcp-remote",
           "http://your-server:port/gradio_api/mcp/sse"
         ]
       }
     }
   }
   ```

4. **Khá»Ÿi Ä‘á»™ng láº¡i**: Náº¿u gáº·p váº¥n Ä‘á» káº¿t ná»‘i, hÃ£y thá»­ khá»Ÿi Ä‘á»™ng láº¡i cáº£ MCP Client vÃ  MCP Server.

## Chia sáº» MCP Server cá»§a báº¡n

Báº¡n cÃ³ thá»ƒ chia sáº» MCP Server báº±ng cÃ¡ch publish á»©ng dá»¥ng Gradio lÃªn Hugging Face Spaces. Video dÆ°á»›i Ä‘Ã¢y hÆ°á»›ng dáº«n cÃ¡ch táº¡o Hugging Face Space.

<Youtube id="3bSVKNKb_PY" />

Giá» báº¡n cÃ³ thá»ƒ chia sáº» MCP Server vá»›i ngÆ°á»i khÃ¡c báº±ng cÃ¡ch chia sáº» Hugging Face Space cá»§a mÃ¬nh.

## Káº¿t luáº­n

Viá»‡c tÃ­ch há»£p Gradio vá»›i MCP mang Ä‘áº¿n Ä‘iá»ƒm khá»Ÿi Ä‘áº§u dá»… tiáº¿p cáº­n vÃ o há»‡ sinh thÃ¡i MCP. Báº±ng cÃ¡ch táº­n dá»¥ng sá»± Ä‘Æ¡n giáº£n cá»§a Gradio vÃ  thÃªm chuáº©n hÃ³a tá»« MCP, cÃ¡c báº¡n cÃ³ thá»ƒ nhanh chÃ³ng táº¡o cáº£ giao diá»‡n thÃ¢n thiá»‡n vá»›i ngÆ°á»i dÃ¹ng láº«n cÃ´ng cá»¥ truy cáº­p Ä‘Æ°á»£c báº±ng AI vá»›i Ã­t code nháº¥t.

Trong suá»‘t khÃ³a há»c nÃ y, chÃºng ta sáº½ khÃ¡m phÃ¡ thÃªm nhiá»u cÃ¡ch triá»ƒn khai MCP phá»©c táº¡p hÆ¡n, nhÆ°ng Gradio váº«n lÃ  Ä‘iá»ƒm khá»Ÿi Ä‘áº§u tuyá»‡t vá»i Ä‘á»ƒ hiá»ƒu vÃ  thá»­ nghiá»‡m vá»›i giao thá»©c